// Xanoty â€“ Prisma schema
// Database: PostgreSQL (recommended). For SQLite use: url = "file:./dev.db" and change provider to "sqlite"
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model BlacklistEntry {
  id        String   @id @default(cuid())
  identifier String // IMVU username or cid
  reason    String?  // optional reason
  addedById String?  // Discord user id who added (from JWT sub)
  createdAt DateTime @default(now())

  @@unique([identifier])
  @@map("blacklist_entries")
}

model ImageLoggerImage {
  id          String   @id @default(cuid())
  slug        String   @unique // URL-safe id for tracking link
  filePath    String   // path relative to uploads dir
  originalName String
  mimeType    String?
  addedById   String?
  createdAt   DateTime @default(now())
  hits        ImageLoggerHit[]

  @@map("image_logger_images")
}

model ImageLoggerHit {
  id        String   @id @default(cuid())
  imageId   String
  image     ImageLoggerImage @relation(fields: [imageId], references: [id], onDelete: Cascade)
  ip        String?
  userAgent String?
  referer   String?
  createdAt DateTime @default(now())

  @@map("image_logger_hits")
}
